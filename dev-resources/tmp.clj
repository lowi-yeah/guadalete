[{:name :fix, :job {:workflow [[:370b10c0-0ccf-43e3-bc8a-698459d52d05-brightness :370b10c0-0ccf-43e3-bc8a-698459d52d05-inner] [:370b10c0-0ccf-43e3-bc8a-698459d52d05-inner :370b10c0-0ccf-43e3-bc8a-698459d52d05-out] [:370b10c0-0ccf-43e3-bc8a-698459d52d05-out :an-mqtt-light-in] [:an-mqtt-light-in :an-mqtt-light-sink] [:sine-out :370b10c0-0ccf-43e3-bc8a-698459d52d05-brightness]], :lifecycles [{:lifecycle/task :sine-out, :lifecycle/calls :onyx.plugin.kafka/read-messages-calls} {:lifecycle/task :370b10c0-0ccf-43e3-bc8a-698459d52d05-brightness, :lifecycle/calls :guadalete.onyx.tasks.items.color/in-color-lifecycle-calls} {:lifecycle/task :370b10c0-0ccf-43e3-bc8a-698459d52d05-inner, :lifecycle/calls :guadalete.onyx.tasks.items.color/color-lifecycle-calls} {:lifecycle/task :370b10c0-0ccf-43e3-bc8a-698459d52d05-out, :lifecycle/calls :guadalete.onyx.tasks.identity/dissoc-lifecycle-calls} {:lifecycle/task :an-mqtt-light-in, :lifecycle/calls :guadalete.onyx.tasks.identity/log-lifecycle-calls} {:lifecycle/task :an-mqtt-light-sink, :lifecycle/calls :guadalete.onyx.plugin.mock-mqtt/publish-calls}], :catalog [{:kafka/zookeeper "zookeeper1:2181", :onyx/plugin :onyx.plugin.kafka/read-messages, :filter/signal-id "sine", :onyx/medium :kafka, :kafka/offset-reset :largest, :kafka/force-reset? true, :onyx/batch-timeout 100, :onyx/type :input, :onyx/name :sine-out, :kafka/topic "gdlt-sgnl-v", :kafka/group-id "sgnl-b5488101-fc28-4ab6-87c4-ab865c7e981a", :onyx/max-peers 1, :onyx/min-peers 1, :onyx/doc "Consumes gdlt-sgnl-v messages from Kafka", :kafka/empty-read-back-off 50, :kafka/fetch-size 307200, :onyx/batch-size 1, :kafka/deserializer-fn :guadalete.onyx.tasks.util/deserialize-message-json, :kafka/wrap-with-metadata? false, :kafka/commit-interval 50, :kafka/chan-capacity 100} {:onyx/fn :guadalete.onyx.tasks.items.color/assoc-channel, :onyx/uniqueness-key :at, :onyx/batch-timeout 100, :onyx/type :function, :onyx/name :370b10c0-0ccf-43e3-bc8a-698459d52d05-brightness, :onyx/max-peers 1, :onyx/min-peers 1, :color/channel :brightness, :onyx/doc "Assocs the color channel with each segment.", :onyx/batch-size 1} {:onyx/min-peers 1, :onyx/max-peers 1, :onyx/batch-size 1, :onyx/batch-timeout 100, :onyx/name :370b10c0-0ccf-43e3-bc8a-698459d52d05-inner, :onyx/fn :guadalete.onyx.tasks.items.color/make-color, :onyx/type :function, :onyx/uniqueness-key :at, :onyx/doc "Logs the color to the console for debugging"} {:onyx/min-peers 1, :onyx/max-peers 1, :onyx/batch-size 1, :onyx/batch-timeout 100, :onyx/name :370b10c0-0ccf-43e3-bc8a-698459d52d05-out, :onyx/fn :guadalete.onyx.tasks.identity/dissoc-and-log, :onyx/type :function, :dissoc/keys [:data :id :at :channel]} {:onyx/min-peers 1, :onyx/max-peers 1, :onyx/batch-size 1, :onyx/batch-timeout 100, :onyx/name :an-mqtt-light-in, :onyx/fn :guadalete.onyx.tasks.identity/log, :onyx/type :function, :called-by "light/in!"} {:mqtt/client-id "lght-an-mqtt-light", :onyx/plugin :guadalete.onyx.plugin.mock-mqtt/publish, :onyx/medium :mqtt, :mqtt/topic "lght/out", :onyx/batch-timeout 100, :onyx/type :output, :onyx/name :an-mqtt-light-sink, :color/mapping-fn :guadalete.onyx.tasks.items.light/hsv->rgb, :onyx/max-peers 1, :onyx/min-peers 1, :color/type :hsv, :onyx/doc "Publishes segment to mqtt", :mqtt/broker "tcp://mosquitto1:1883", :onyx/batch-size 1}], :triggers [], :windows [{:window/id :windowwww-.static.uuid$random_uuid@3c1c0657, :window/task :370b10c0-0ccf-43e3-bc8a-698459d52d05-inner, :window/type :global, :window/aggregation :guadalete.onyx.tasks.items.color/map-color, :window/window-key :at, :map-key :id}], :flow-conditions [{:flow/from :sine-out, :flow/to :all, :flow/predicate :guadalete.onyx.filters/signal-id, :flow/short-circuit? true}], :task-scheduler :onyx.task-scheduler/balanced}} {:name :signal/value-logger, :job {:workflow [[:read-from-kafka :write-to-redis]], :lifecycles [{:lifecycle/task :read-from-kafka, :lifecycle/calls :onyx.plugin.kafka/read-messages-calls} {:lifecycle/task :log, :lifecycle/calls :guadalete.onyx.tasks.identity/log-lifecycle-calls} {:redis/uri "redis://redis1:6379", :redis/read-timeout-ms 8000, :redis/signal-prefix "sgnl", :redis/namespace "gdlt", :lifecycle/task :write-to-redis, :lifecycle/calls :guadalete.onyx.tasks.redis/timeseries-lifecycle, :onyx/param? true, :lifecycle/doc "Initialises the redis-timeseries-lifecycle"}], :catalog [{:kafka/zookeeper "zookeeper1:2181", :onyx/plugin :onyx.plugin.kafka/read-messages, :onyx/medium :kafka, :kafka/offset-reset :largest, :kafka/force-reset? true, :onyx/batch-timeout 100, :onyx/type :input, :onyx/name :read-from-kafka, :kafka/topic "gdlt-sgnl-v", :kafka/group-id "signal-value-consumer", :onyx/max-peers 1, :onyx/min-peers 1, :onyx/doc "Consumes gdlt-sgnl-v messages from Kafka", :kafka/empty-read-back-off 50, :kafka/fetch-size 307200, :onyx/batch-size 1, :kafka/deserializer-fn :guadalete.onyx.tasks.util/deserialize-message-json, :kafka/wrap-with-metadata? false, :kafka/commit-interval 50, :kafka/chan-capacity 100} {:onyx/min-peers 1, :onyx/max-peers 1, :onyx/batch-size 1, :onyx/batch-timeout 100, :onyx/name :log, :onyx/fn :guadalete.onyx.tasks.identity/log, :onyx/type :function, :called-by "signal-timeseries-consumer"} {:onyx/fn :clojure.core/identity, :onyx/plugin :onyx.peer.function/function, :onyx/medium :function, :onyx/batch-timeout 100, :onyx/type :output, :onyx/name :write-to-redis, :onyx/max-peers 1, :onyx/min-peers 1, :onyx/doc "Provide an anchor where lifecycle functions can hook into… ", :onyx/batch-size 1}], :triggers [], :windows [], :flow-conditions [], :task-scheduler :onyx.task-scheduler/balanced}} {:name :signal/config-handler, :job {:workflow [[:read-from-kafka :write-to-rethink]], :lifecycles [{:lifecycle/task :read-from-kafka, :lifecycle/calls :onyx.plugin.kafka/read-messages-calls} {:lifecycle/task :write-to-rethink, :lifecycle/calls :guadalete.onyx.tasks.rethink/rethink-lifecycle, :rethinkdb/host "127.0.0.1", :rethinkdb/port 28015, :rethinkdb/auth-key "", :rethinkdb/db "guadalete", :rethinkdb/tables ["signal" "light" "room" "switch"], :rethinkdb/table "signal"}], :catalog [{:kafka/zookeeper "zookeeper1:2181", :onyx/plugin :onyx.plugin.kafka/read-messages, :onyx/medium :kafka, :kafka/offset-reset :largest, :kafka/force-reset? true, :onyx/batch-timeout 100, :onyx/type :input, :onyx/name :read-from-kafka, :kafka/topic "gdlt-sgnl-c", :kafka/group-id "signal-config-consumer", :onyx/max-peers 1, :onyx/min-peers 1, :onyx/doc "Consumes gdlt-sgnl-c messages from Kafka", :kafka/empty-read-back-off 50, :kafka/fetch-size 307200, :onyx/batch-size 1, :kafka/deserializer-fn :guadalete.onyx.tasks.util/deserialize-message-json, :kafka/wrap-with-metadata? false, :kafka/commit-interval 50, :kafka/chan-capacity 100} {:onyx/fn :clojure.core/identity, :onyx/plugin :onyx.peer.function/function, :onyx/medium :function, :onyx/batch-timeout 100, :onyx/type :output, :onyx/name :write-to-rethink, :onyx/max-peers 1, :onyx/min-peers 1, :onyx/doc "Does nothing (identity) but provide a place where lifecycle functions can hook into… ", :onyx/batch-size 1}], :triggers [], :windows [], :flow-conditions [], :task-scheduler :onyx.task-scheduler/balanced}}]